#!/bin/bash
#$1=file_to_search
#$2=orig_file_name

# when macros are expanded all the header files are prepended to the file, this makes for too large a file
#this script tries to strip the completely macro expanded fil back to its original size


declare -i first_orig_line

#                     looks like :# 347 "stdio.h"  | remove the lines that aren't the original file  | get the last line not from the original file| grab only the number of that line
first_orig_line=`cat "$1" | grep -n '^[#] [0-9]*'  | grep -v $2                                      | tail -n 1                                   | sed 's/\([0-9]*\).*/\1/'`

#echo $first_orig_line
declare -i total_file_length
total_file_length=`cat "$1" | wc -l`

#echo $total_file_length
declare -i tail_size
tail_size=$total_file_length-$first_orig_line
#echo $tail_size

tail -n "$tail_size" $1